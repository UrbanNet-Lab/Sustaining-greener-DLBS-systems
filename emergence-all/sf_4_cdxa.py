#人和车的指标对比
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import random
from scipy.optimize import curve_fit
from scipy.special import factorial
import time


def log_pdf(x,y):
#    bins=np.logspace(0, 4, 20,base=2)
    bins=np.logspace(0, 3, 30)
    bins2=list(bins)
    bins_all={}
    for i in range(len(bins)-1):
        bins_all[bins[i]]=[]
    widths = (bins[1:] - bins[:-1])
    for i in range(len(x)):
        if(x[i]>=1):
            for j in range(len(bins)):
                if(x[i]<bins[j]):
                    bins_all[bins[j-1]].append(y[i])
                    break
                if(x[i]==bins[j]):
                    bins_all[bins[j]].append(y[i])
                    break
    x_new=[]
    y_new=[]
    for key,value in bins_all.items():
        if(len(value)>0):
#            index_this=bins2.index(key)
#            y_new.append(np.sum(value)/widths[index_this])
            y_new.append(np.mean(value))
            x_new.append(key)
        
    return x_new,y_new

trips_cd_x=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 
            22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
            41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 
            60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 
            79, 80, 81, 82, 83, 84, 85, 93, 95]
trips_cd_y=[0.04243431919582082, 0.04956781540762576, 0.03633908248354577, 0.03800538007195211, 
            0.03601961802215196, 0.035707414116698914, 0.03547507632659433, 0.036026878578092725,
            0.03468004545108019, 0.035409731323127414, 0.034407774603301376, 0.034632851837465194,
            0.03364178595155031, 0.03309724425599268, 0.03175404140695053, 0.030748454409154108, 
            0.02906037515292546, 0.028276235111322472, 0.026668021970442275, 0.026061765549388115,
            0.024101415445380654, 0.021905097273298216, 0.020344077746033015, 0.019222321853184298,
            0.017058676182835318, 0.01576992750334893, 0.014350488816928712, 0.013461070714184585, 
            0.012284860651780107, 0.010883573355211808, 0.010150257205194201, 0.00935159605170968, 
            0.008505741284610163, 0.007881333473704082, 0.007089932876160328, 0.00665066924174384, 
            0.0062694900548535, 0.005913722813755849, 0.005721318081325487, 0.0054962408471616675,
            0.0051223222162120954, 0.004995262487248649, 0.00478833664293675, 0.004389006066194488, 
            0.004011457157274532, 0.003971524099600306, 0.004138516886237979, 0.0037065138077622605,
            0.0034015704582499883, 0.0033725282344869148, 0.003024021549330032, 0.002813465427047749,
            0.00249400096565394, 0.002345159568868188, 0.0022616631755493517, 0.001967610659948232,
            0.0017389031478140281, 0.0015900617510282763, 0.0014266992423609876, 0.0012088825641379361,
            0.0009620236621518109, 0.0010055869977964214, 0.0008603758789810536, 0.0007587280958102962,
            0.0005445416955576288, 0.0005445416955576288, 0.00037028835297918763, 0.00035939751906803504,
            0.0002287075121342041, 0.0002504891799565093, 0.00022144695619343574, 0.00015973223069690447,
            0.0001379505628745993, 6.897528143729965e-05, 7.260555940768384e-05, 5.082389158537869e-05,
            6.534500346691547e-05, 3.2672501733457734e-05, 1.815138985192096e-05, 2.1781667822305153e-05,
            2.1781667822305153e-05, 3.6302779703841922e-06, 1.815138985192096e-05, 1.0890833911152577e-05,
            1.0890833911152577e-05, 3.6302779703841922e-06, 3.6302779703841922e-06]
trips_xa_x2=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22,
             23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42,
             43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 
             63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 
             83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 
             102, 103, 104, 105, 106, 107, 108, 109, 110, 112, 114, 115, 117, 119]
trips_xa_y2=[0.03923385228897706, 0.04441669519915678, 0.025914214550898606, 0.026249890905184856,
             0.02136915671386276, 0.020704517532375986, 0.018744167623344278, 0.01983175901123173,
             0.017401462206199272, 0.017857982048028572, 0.01675696360596967, 0.01677039066014112,
             0.015924486247339765, 0.01670325538928387, 0.015850637449396788, 0.015763361597282366,
             0.015253133538767262, 0.015253133538767262, 0.015065154780366961, 0.01578350217853954, 
             0.01463548904688056, 0.014951024819909635, 0.015206138849167187, 0.014380375017623008, 
             0.01491745718448101, 0.015071868307452687, 0.015058441253281237, 0.015145717105395662,
             0.014575067303109035, 0.015199425322081461, 0.014850321913623761, 0.015199425322081461, 
             0.014521359086423234, 0.01478318664276651, 0.014400515598880184, 0.014823467805280861,
             0.01487717602196666, 0.014313239746765759, 0.014601921411451935, 0.013447194752707229,
             0.01335320537350708, 0.013923855175793707, 0.013373345954764254, 0.013581465294421731, 
             0.012634857975334502, 0.01211120286264795, 0.012527441541962902, 0.011815807670876049, 
             0.01128543903110377, 0.011245157868589421, 0.010808778608017294, 0.01004343652024464,
             0.00974804132847274, 0.009560062570072438, 0.008982699240700087, 0.008472471182184985,
             0.008156935409155908, 0.007646707350640806, 0.00723718219841158, 0.007055916967097004,
             0.006800802937839453, 0.006122736702181225, 0.005867622672923674, 0.005142561747665371,
             0.004947869462179345, 0.004840453028807745, 0.004531630782864393, 0.004283230280692567, 
             0.003410471759548314, 0.003511174665834189, 0.002967378971890462, 0.003014373661490537, 
             0.002477291494632535, 0.0023295938987465846, 0.002275885682060784, 0.0018932146381744578,
             0.0019267822736030828, 0.0015776788651453814, 0.0015306841755453062, 0.0013762730525736307,
             0.0012889972004592053, 0.0010003155357730291, 0.0010607372795445544, 0.0008324773586299034, 
             0.0006579256544010527, 0.000718347398172578, 0.0006444986002296026, 0.0004162386793149517,
             0.00040952515222922667, 0.00044309278765785183, 0.0003423898813719764, 0.0002752546105147261,
             0.00020811933965747586, 0.0002685410834290011, 0.00022825992091465093, 0.00015441112297167562,
             0.00013427054171450054, 0.0001208434875430505, 8.727585211442536e-05, 7.38487979429753e-05, 
             6.713527085725027e-05, 8.056232502870033e-05, 5.370821668580022e-05, 3.3567635428625135e-05, 
             4.699468960007519e-05, 3.3567635428625135e-05, 2.685410834290011e-05, 3.3567635428625135e-05, 
             6.713527085725027e-06, 6.713527085725027e-06, 6.713527085725027e-06, 1.3427054171450054e-05,
             1.3427054171450054e-05, 6.713527085725027e-06, 6.713527085725027e-06]


dis_cd_x1=[0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5, 14.5,
           15.5, 16.5, 17.5, 18.5, 19.5, 20.5, 21.5, 22.5, 23.5, 24.5, 25.5, 26.5, 28.5, 29.5, 
           30.5, 31.5, 32.5, 33.5, 34.5, 66.5]
dis_cd_y1=[0.5111830712877685, 0.447075992608754, 0.026929401984309938, 0.006403810339757715,
           0.0029659371018038853, 0.0015573892492948185, 0.0009729144960629636, 0.0005808444752614708,
           0.0005118691938241711, 0.0003339855732753457, 0.000377548908919956, 0.00015247167475613608,
           0.00012705972896344674, 0.00017425334257844123, 0.00010164778317075738, 9.801750520037319e-05,
           4.71936136149945e-05, 2.9042223763073538e-05, 2.5411945792689346e-05, 4.71936136149945e-05, 
           3.2672501733457734e-05, 4.356333564461031e-05, 2.1781667822305153e-05, 1.4521111881536769e-05,
           9.4387227229989e-05, 1.0890833911152577e-05, 1.4521111881536769e-05, 1.0890833911152577e-05,
           2.9042223763073538e-05, 3.6302779703841922e-06, 7.2605559407683845e-06, 3.6302779703841922e-06,
           1.0890833911152577e-05, 3.6302779703841922e-06, 3.6302779703841922e-06]
dis_xa_x2=[0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5, 14.5, 
           15.5, 16.5, 17.5, 18.5, 20.5, 21.5, 22.5, 23.5, 24.5, 25.5, 27.5]
dis_xa_y2=[0.1821715574711486, 0.7314723436251703, 0.06720240612810753, 0.009560062570072438,
           0.0036387316804629647, 0.0017992252589743073, 0.0010875913878874545, 0.000718347398172578,
           0.00035581693554342643, 0.000248400502171826, 0.00016112465005740066, 4.699468960007519e-05,
           0.00022825992091465093, 0.00016783817714312568, 2.685410834290011e-05, 3.3567635428625135e-05,
           8.056232502870033e-05, 6.713527085725027e-06, 2.685410834290011e-05, 6.713527085725027e-06,
           1.3427054171450054e-05, 4.0281162514350165e-05, 6.713527085725027e-06, 0.00018797875840030075,
           0.0007049203440011279, 6.713527085725027e-06]


gy_cd_x=[0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5, 14.5, 15.5, 17.5]
gy_cd_y=[0.38611273465209234, 0.3246303469456656, 0.16364204007100824, 0.07438802589114249, 
         0.030421729391819533, 0.01198354758023822, 0.004973480819426343, 0.002178166782230515,
         0.0008240730992772117, 0.0004138516886237979, 0.000188774454459978, 0.00011616889505229415,
         6.534500346691547e-05, 3.630277970384192e-05, 1.0890833911152577e-05, 1.0890833911152577e-05,
         3.6302779703841922e-06]
gy_xa_x2=[0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5]
gy_xa_y2=[0.18953629668418898, 0.18209099514611993, 0.22786382281659315, 0.20587030808375797, 
          0.11833262841298933, 0.05058642659093808, 0.017085926433170195, 0.005807200929152149,
          0.0017589440964599571, 0.0006780662356582278, 0.00018126523131457574, 0.00014098406880022558,
          4.699468960007519e-05, 2.0140581257175083e-05]


days_cd_x=[]
days_cd_y=[]
days_xa_x2=[]
days_xa_y2=[]


rank_cd_x=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 
           24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45]
rank_cd_y=[0.40243447935800647, 0.20508060369595305, 0.1364814134412314, 0.10222210050392119,
           0.0814753311525588, 0.06774214574691868, 0.058192287393524444, 0.05130529443971022, 
           0.046011036177569596, 0.04173268469691065, 0.03813123104824341, 0.03501189814578073, 
           0.03226645277228, 0.029879504126017347, 0.027891708289604432, 0.026291687333346244, 
           0.02499282660762773, 0.023940568274706663, 0.023093023179627605, 0.022367886159168036,
           0.02174423139229755, 0.021123720468416485, 0.020602323080778053, 0.020083099417274656,
           0.01961873845600744, 0.019196161212364025, 0.018729126563248023, 0.01836151250011585, 
           0.018011540207143354, 0.017655895978378355, 0.0173253106547887, 0.017001949326633948, 
           0.01665386450455534, 0.016293854570832333, 0.015964932339595263, 0.01570052878917675, 
           0.015394582683401199, 0.015195125277597359, 0.014873134352143115, 0.0148064849664319,
           0.014291515112001775, 0.013989101298470794, 0.01375770717786669, 0.013839105065984415, 
           0.013066349906668929]
rank_cd_std=[0.25554538401313387, 0.09614360286052907, 0.053421773374521836, 0.036584055169108586,
             0.027430855074069182, 0.02176256875195906, 0.017925364791240683, 0.015195020914116326,
             0.01313413918899468, 0.011699099518028201, 0.010602761273883116, 0.009763387774890279, 
             0.00897221604080907, 0.00822195960808447, 0.007458635094080814, 0.006734189284054061,
             0.006093680415693605, 0.0055545277901452505, 0.005091371093272393, 0.0046792888717903285,
             0.004325020169612527, 0.003980796547330093, 0.003706353742822689, 0.0034511582646004216, 
             0.0032635670169392345, 0.0030767641447663955, 0.002849753163279065, 0.002707906506924718, 
             0.002556199504538826, 0.002422725872170536, 0.002305332589711043, 0.002236537675324359, 
             0.0020871325012024036, 0.0019418637200085483, 0.0018838035845096185, 0.0018536331441020252,
             0.0017154113326943968, 0.0017003954042858888, 0.0016323238382685247, 0.001618651244751802,
             0.0015703305791388287, 0.0017820120999142927, 0.0011974659198966955, 0.001373097607962358,
             0.0010181571355845917]
rank_xa_x2=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 
            24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 
            45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64]
rank_xa_y2=[0.2872238845844952, 0.15128579500500514, 0.10560985259755072, 0.08388785700475751,
            0.06999079217593436, 0.06019280409546803, 0.05283368522565804, 0.047022438901325694,
            0.04237751421585547, 0.03853521983914239, 0.03529388380420324, 0.03259155240857665, 
            0.030307727160785964, 0.02836259741177109, 0.02672643549011884, 0.025306027354508688, 
            0.02414788731981141, 0.023138493140643798, 0.02224681919003323, 0.021515358111195967, 
            0.02085832508979533, 0.020230922863314633, 0.0196869109313273, 0.01916705457465536,
            0.018679566030919602, 0.018232833247432113, 0.01781229007323491, 0.017384071361773577,
            0.016991030689070815, 0.01661961655795706, 0.016266598708455992, 0.01593650999917562, 
            0.015585317630151248, 0.015258928126869345, 0.014950365940718273, 0.014665876132286803,
            0.014398521212188016, 0.014116969045416258, 0.013845377544036301, 0.013577664844113772, 
            0.013310937454685617, 0.013088004920783802, 0.012861752791819512, 0.012642183647921478, 
            0.012431632130950249, 0.012249434420268001, 0.012050041672179964, 0.011871479668990671, 
            0.011687665028185374, 0.011507844341250769, 0.011173865552591608, 0.01108220641977645, 
            0.010845347492103126, 0.01064809338403679, 0.010270404226538958, 0.010086670133763177, 
            0.009918850629361375, 0.009945114725021839, 0.010127384166988128, 0.010133977683482636,
            0.009712399811409714, 0.009712399811409714, 0.009523809523809525, 0.009523809523809525]
rank_xa_std2=[0.2553504869704846, 0.09505172247020487, 0.049903018780893274, 0.03382959045546013,
              0.025252906454730988, 0.020160996009576736, 0.016813733091458498, 0.014415031639160893,
              0.012697875308937906, 0.011390376990060373, 0.010339062144778073, 0.009456777288918802, 
              0.008751591755526096, 0.008105563487021182, 0.007561590818085781, 0.007058629057727579,
              0.006608760118864645, 0.006191569321370679, 0.005808323939750133, 0.0054678314567863035, 
              0.0051564072540777744, 0.004836829050503958, 0.004553841563904057, 0.0042869472020861405, 
              0.004030993792068582, 0.0037988677021165854, 0.0035931959456976673, 0.0033916434620101213,
              0.003198860115271151, 0.00304211464661876, 0.0028879628262909233, 0.002752320330731992,
              0.002604082504925973, 0.0024688525121745355, 0.0023425614002141972, 0.0022422752831493475, 
              0.0021683703380106977, 0.0020663134204491227, 0.0019711166440950015, 0.0018803334717158386,
              0.0017751064212109284, 0.0017193100554539517, 0.00164659049220812, 0.0015895594176468498, 
              0.001486178886279279, 0.0014539995681247025, 0.0014238483150742695, 0.001354829775965192,
              0.0013418291871899854, 0.0013184903119890096, 0.0012211138422383902, 0.0011354458961377772,
              0.0010942794403592448, 0.0011544907108216953, 0.000875283824605992, 0.0007193023483576846,
              0.0005432162112189534, 0.0005707548590767327, 0.000529187611694175, 0.0005914660076153273, 
              0.00018859028760018822, 0.00018859028760018822, 0.0, 0.0]


ith_cd_x=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,
          24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 
          45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65,
          66, 67, 68, 69, 70, 71, 72, 73, 76, 77, 78, 81, 84]
ith_cd_y=[0.17204613357244763, 0.10453022387924243, 0.08107499791259017, 0.06892808782368466, 
          0.061493278540337835, 0.0545412962270521, 0.04924835094623195, 0.04282275893865193,
          0.03838655925884245, 0.035028552136237075, 0.03083558108044333, 0.027611894242742168,
          0.025270364951844364, 0.02249683258247084, 0.02008995828810612, 0.01773390788532678,
          0.015846163340727, 0.014397682430543707, 0.012404659824802785, 0.010934397246797187, 
          0.010088542479697671, 0.008618279901692073, 0.007652625961569877, 0.007405767059583753, 
          0.006077085322423138, 0.005579737240480504, 0.005184036941708626, 0.004436199679809483, 
          0.003967893821629922, 0.003492327407509593, 0.0030893665527969476, 0.00283161681689967, 
          0.0027227084777881445, 0.002341529290897804, 0.002232620951786278, 0.0017606848156363332, 
          0.0016263645307321181, 0.001586431473057892, 0.0014012872965682983, 0.0013359422931013827,
          0.001303269791367925, 0.0010527806114114158, 0.000907569492596048, 0.000907569492596048,
          0.0009184603265072007, 0.0006716014245210756, 0.000736946427987991, 0.0006098866990245443,
          0.0004791966920907134, 0.0004973480819426343, 0.00032309473936419314, 0.0002904222376307354, 
          0.0003739186309495718, 0.0003303552953049615, 0.00030131307154188797, 0.00019603501040074637,
          0.0001415808408449835, 0.0001415808408449835, 0.00012705972896344674, 0.00011253861708190996, 
          6.534500346691547e-05, 7.260555940768384e-05, 5.445416955576289e-05, 6.171472549653127e-05, 
          3.2672501733457734e-05, 2.5411945792689346e-05, 1.4521111881536769e-05, 2.9042223763073538e-05,
          1.4521111881536769e-05, 1.0890833911152577e-05, 7.2605559407683845e-06, 7.2605559407683845e-06,
          3.6302779703841922e-06, 3.6302779703841922e-06, 3.6302779703841922e-06, 1.0890833911152577e-05,
          3.6302779703841922e-06, 3.6302779703841922e-06]
ith_xa_x2=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 
           24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44,
           45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 
           66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86,
           87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 101, 106]
ith_xa_y2=[0.14362919847200123, 0.08633595832242386, 0.05946170939826657, 0.04703497076258954,
           0.040791390572865266, 0.03710566420280222, 0.035098319604170446, 0.03333937550771049,
           0.031452874396621755, 0.029996039019019424, 0.028210240814216563, 0.026914530086671634,
           0.025659100521641054, 0.02412841634609575, 0.022121071747463965, 0.021214745590891086,
           0.02071123105946171, 0.01889186521923023, 0.018012393171000247, 0.01607889737031144, 
           0.01491745718448101, 0.01378287110699348, 0.013521043550650206, 0.012641571502420226,
           0.011412996045732546, 0.01076178391841722, 0.010875913878874544, 0.00950635435338664,
           0.008975985713614361, 0.008902136915671386, 0.008331487113384758, 0.007546004444354931,
           0.007270749833840204, 0.006733667666982203, 0.0062905748793243505, 0.006163017864695575,
           0.005894476781266574, 0.005122421166408196, 0.005229837599779796, 0.004739750122521869, 
           0.0042496626452639425, 0.004115392103549441, 0.003833423965948991, 0.0035044611387484645, 
           0.003376904124119689, 0.0029270978093761117, 0.0027458325780615363, 0.0024034426966895598,
           0.002423583277946735, 0.002262458627889334, 0.0021013339778319334, 0.002188609829946359,
           0.0018865011110887327, 0.0016313870818311816, 0.0016179600276597316, 0.0013762730525736307,
           0.0011614401858304297, 0.0011010184420589045, 0.0007921961961155533, 0.001007029062858754, 
           0.0009130396836586037, 0.0009130396836586037, 0.0006914932898296778, 0.0006780662356582278,
           0.0006042174377152525, 0.0005236551126865522, 0.0004363792605721268, 0.00047666042308647694,
           0.0002618275563432761, 0.00034910340845770144, 0.0002752546105147261, 0.0002618275563432761,
           0.0001946922854860258, 0.0002752546105147261, 0.0001946922854860258, 0.00021483286674320087, 
           0.00016783817714312568, 0.00015441112297167562, 0.00014098406880022558, 0.00012755701462877553,
           8.056232502870033e-05, 9.398937920015038e-05, 7.38487979429753e-05, 6.713527085725027e-05, 
           4.0281162514350165e-05, 4.699468960007519e-05, 2.685410834290011e-05, 2.685410834290011e-05,
           3.3567635428625135e-05, 4.0281162514350165e-05, 1.3427054171450054e-05, 3.3567635428625135e-05,
           1.3427054171450054e-05, 6.713527085725027e-06, 6.713527085725027e-06, 6.713527085725027e-06,
           6.713527085725027e-06, 6.713527085725027e-06, 6.713527085725027e-06]


unique_t_cd_x1=[1.0, 1.6102620275609394, 2.592943797404667, 3.2903445623126686, 4.1753189365604015, 
                5.298316906283708, 6.7233575364993365, 8.531678524172808, 10.826367338740546, 
                13.73823795883263, 17.43328822199988, 22.122162910704493, 28.072162039411772, 
                35.62247890262442, 45.20353656360243, 57.36152510448679, 72.7895384398315, 
                92.36708571873861, 117.21022975334806, 148.73521072935117]
unique_t_cd_y1=[2.0554934060220273, 2.296127186709209, 2.309453494649265, 2.451150424023356, 
                2.8573030295951973, 3.005983434293485, 3.124612765622485, 3.4203643905563252,
                3.566561514743716, 3.5700471745076827, 3.886136185088362, 4.972496845778415,
                4.669384149983753, 4.988641056577185, 6.286418268228768, 7.078515938095009, 
                8.916328502711647, 10.959936697709372, 13.285754550387521, 14.443699160090402]
unique_t_xa_x2=[1.0, 1.6102620275609394, 2.592943797404667, 3.2903445623126686, 4.1753189365604015, 
                5.298316906283708, 6.7233575364993365, 8.531678524172808, 10.826367338740546,
                13.73823795883263, 17.43328822199988, 22.122162910704493, 28.072162039411772, 
                35.62247890262442, 45.20353656360243, 57.36152510448679, 72.7895384398315, 
                92.36708571873861, 117.21022975334806, 148.73521072935117]
unique_t_xa_y2=[2.5988082765845992, 3.021993533992077, 3.150870406189555, 3.3582836337644353,
                3.7412773731888653, 3.960134338306927, 4.375783340391459, 4.722994796183102, 
                5.2473075867395025, 5.697030544258999, 5.94976438424051, 7.268183954250692,
                7.698834860119054, 7.982090175942744, 9.698175250856996, 11.543649001703534,
                14.293144976921056, 17.497703604151567, 21.284990988066465, 24.823414028069504]



#normal
def func1(x,mu,sigma):
    return np.exp(-((x - mu)**2)/(2*sigma**2)) / (sigma * np.sqrt(2*np.pi))

def func2(x, a,b1,b2,c):
    return a*pow(x+c,-b1)*np.exp((-b2)*x)

#泊松    
def func3(x, a):
    return (a**x/factorial(x)) * np.exp(-a)

#幂律 
def func4(x, a, b):
    return a*pow(x,b)

def func5(x, a,b1,b2):
    return a*pow(x,-b1)*np.exp((-b2)*x)
def func6(x, a, b):
    return a * x + b

def func7(x, a, b):
    return a * np.log(x) + b



f_family='Arial'
size_x=8
size_y=6
alpha_xy=1
fig	=	plt.figure(figsize=(size_x, size_y))
ax1	=	fig.add_subplot(1,	1,	1)
plt.yticks(fontproperties = f_family)
plt.xticks(fontproperties = f_family) 
plt.tick_params(labelsize=18)
popt, pcov = curve_fit(func4, unique_t_cd_x1[10:],unique_t_cd_y1[10:])
y888= [func4(i, *popt) for i in unique_t_cd_x1[0:]]
ax1.scatter(unique_t_cd_x1,unique_t_cd_y1,label=r'D5, $\mu$=%.2f'%popt[1],alpha=alpha_xy)
ax1.plot(unique_t_cd_x1[0:],y888,c='b',linestyle='-')
popt, pcov = curve_fit(func4, unique_t_xa_x2[10:],unique_t_xa_y2[10:])
y777 = [func4(i, *popt) for i in unique_t_xa_x2[0:]]
ax1.scatter(unique_t_xa_x2,unique_t_xa_y2,label=r'D6, $\mu$=%.2f'%popt[1],alpha=alpha_xy)
ax1.plot(unique_t_xa_x2[0:],y777,c='orange',linestyle='-')
ax1.plot([24,24],[1,100],color='k',linestyle='--')
ax1.plot([168,168],[1,100],color='k',linestyle='--')
ax1.plot([720,720],[1,100],color='k',linestyle='--')
ax1.text(19, 70,r'Day', size = 18,family=f_family)
ax1.text(120, 70,r'Week', size = 18,family=f_family)
ax1.text(400, 70,r'Month', size = 18,family=f_family)
ax1.set_yscale('log')
ax1.set_xscale('log')
ax1.set_xlim([1,1000])
ax1.set_ylim([1.6,100])
ax1.legend(loc=2,handletextpad=0.1,prop={'size':18,'family':f_family})
ax1.set_xlabel('t(h)',size=18,family=f_family) 
ax1.set_ylabel(r'S(t)',size=18,family=f_family)
#plt.savefig('C:/python/摩拜单车/draw2/sf_4_cdxa1.pdf',bbox_inches='tight') 


fig2	=	plt.figure(figsize=(size_x, size_y))
ax2	=	fig2.add_subplot(1,	1,	1)
plt.yticks(fontproperties = f_family)
plt.xticks(fontproperties = f_family) 
plt.tick_params(labelsize=18)
popt, pcov = curve_fit(func4, rank_cd_x,rank_cd_y,maxfev = 10000)
y888 = [func4(i, *popt) for i in rank_cd_x]
ax2.errorbar(rank_cd_x,rank_cd_y,fmt="o",yerr = rank_cd_std,label=r'D5, $\xi$=%.2f'%-popt[1])
ax2.plot(rank_cd_x,y888,color='b',linestyle='-',linewidth=2)
popt, pcov = curve_fit(func4, rank_xa_x2[:],rank_xa_y2[:],maxfev = 10000)
y777 = [func4(i, *popt) for i in rank_xa_x2]
ax2.errorbar(rank_xa_x2,rank_xa_y2,fmt="o",yerr = rank_xa_std2,label=r'D6, $\xi$=%.2f'%-popt[1])
ax2.plot(rank_xa_x2,y777,c='orange',linestyle='-',linewidth=2)
ax2.set_yscale('log')
ax2.set_xscale('log')
ax2.set_ylim([0.001,1])
ax2.legend(loc=3,handletextpad=0.1,prop={'size':18,'family':f_family})
ax2.set_xlabel('log'+r'$_{10}L$',size=18,family=f_family) 
ax2.set_ylabel('log'+r'$_{10}P(L)$',size=18,family=f_family) 
#plt.savefig('C:/python/摩拜单车/draw2/sf_4_cdxa2.pdf',bbox_inches='tight') 


fig3	=	plt.figure(figsize=(size_x, size_y))
ax3	=	fig3.add_subplot(1,	1,	1)
plt.yticks(fontproperties = f_family)
plt.xticks(fontproperties = f_family) 
plt.tick_params(labelsize=18)
ax3.scatter(ith_cd_x,ith_cd_y)
ax3.scatter(ith_xa_x2,ith_xa_y2)
#popt, pcov = curve_fit(func5, ith_x2[:],ith_y2[:],maxfev = 1000000)
#y888 = [func5(i, *popt) for i in ith_x2]
#ax3.scatter(ith_x2,ith_y2,label=r'D4, $\alpha$=%.2f'%popt[1])
#ax3.plot(ith_x2,y888,color='b',linestyle='-')
#popt, pcov = curve_fit(func5, ith_x[:], ith_y[:],maxfev = 10000)
#y777 = [func5(i, *popt) for i in ith_x]
#ax3.scatter(ith_x,ith_y,label=r'D5, $\alpha$=%.2f'%popt[1])
#ax3.plot(ith_x,y777,c='orange',linestyle='-')
ax3.set_ylim([-0.04,0.64])
#ax3.set_yscale('log')
#ax3.set_xscale('log')
#ax3.set_ylim([0.000001,1])
#ax3.set_xlim([0.5,150])
#ax3.legend(loc=3,handletextpad=0.1,prop={'size':18,'family':f_family})
ax3.set_xlabel(r'i$^{th}$ trip',size=18,family=f_family)  
ax3.set_ylabel(r'$P(i)$',size=18,family=f_family)
#plt.savefig('C:/python/摩拜单车/draw2/sf_4_cdxa3.pdf',bbox_inches='tight') 


fig4	=	plt.figure(figsize=(size_x, size_y))
ax4	=	fig4.add_subplot(1,	1,	1)
plt.yticks(fontproperties = f_family)
plt.xticks(fontproperties = f_family) 
plt.tick_params(labelsize=18)
popt, pcov = curve_fit(func1, trips_cd_x[7:],trips_cd_y[7:],maxfev = 10000)
#popt, pcov = curve_fit(func1, trips_cd_x[7:40]+trips_cd_x[50:],trips_cd_y[7:40]+trips_cd_y[50:],maxfev = 10000)
y888 = [func1(i, *popt) for i in trips_cd_x]
ax4.scatter(trips_cd_x,trips_cd_y,label=r'D5, $\mu$=%.2f, $\sigma$=%.2f'%(popt[0],popt[1]),alpha=alpha_xy)
ax4.plot(trips_cd_x,y888,color='b',linestyle='-')
popt, pcov = curve_fit(func1, trips_xa_x2[:],trips_xa_y2[:],maxfev = 10000)
y777 = [func1(i, *popt) for i in trips_xa_x2]
ax4.scatter(trips_xa_x2,trips_xa_y2,label=r'D6, $\mu$=%.2f, $\sigma$=%.2f'%(popt[0],popt[1]),alpha=alpha_xy)
ax4.plot(trips_xa_x2,y777,c='orange',linestyle='-')
ax4.set_yscale('log')
ax4.set_xscale('log')
ax4.set_ylim([0.000001,1])
ax4.set_xlim([0.8,160])
ax4.legend(loc=3,handletextpad=0.1,prop={'size':20,'family':f_family})
ax4.set_xlabel('log'+r'$_{10}$'+'#trips',size=18,family=f_family)  
ax4.set_ylabel('log'+r'$_{10}P$(#)',size=18,family=f_family)
#plt.savefig('C:/python/摩拜单车/draw2/sf_4_cdxa4.pdf',bbox_inches='tight') 


fig5	=	plt.figure(figsize=(size_x, size_y))
ax5	=	fig5.add_subplot(1,	1,	1)
plt.yticks(fontproperties = f_family)
plt.xticks(fontproperties = f_family) 
plt.tick_params(labelsize=18)
#popt, pcov = curve_fit(func5, gy_cd_x[6:],gy_cd_y[6:],maxfev = 10000)
popt, pcov = curve_fit(func3, gy_cd_x[5:],gy_cd_y[5:],maxfev = 10000)
y888 = [func3(i, *popt) for i in gy_cd_x]
#ax5.scatter(gy_cd_x,gy_cd_y,label=r'D5, $\alpha$=%.2f'%popt[1],alpha=0.6)
ax5.scatter(gy_cd_x,gy_cd_y,label=r'D5, $\lambda$=%.2f'%popt[0],alpha=alpha_xy)
ax5.plot(gy_cd_x,y888,color='b',linestyle='-')
popt, pcov = curve_fit(func3, gy_xa_x2[:],gy_xa_y2[:],maxfev = 100000)
y777 = [func3(i, *popt) for i in gy_xa_x2]
ax5.scatter(gy_xa_x2,gy_xa_y2,label=r'D6, $\lambda$=%.2f'%popt[0])
ax5.plot(gy_xa_x2,y777,c='orange',linestyle='-')
ax5.set_yscale('log')
ax5.set_xscale('log')
ax5.set_ylim([0.000001,1])
ax5.legend(loc=3,handletextpad=0.1,prop={'size':18,'family':f_family})
ax5.set_xlabel('log'+r'$_{10}r_g$'+'(km)',size=18,family=f_family) 
ax5.set_ylabel('log'+r'$_{10}P(r_g)$',size=18,family=f_family)
#plt.savefig('C:/python/摩拜单车/draw2/sf_4_cdxa5.pdf',bbox_inches='tight') 


fig6	=	plt.figure(figsize=(size_x, size_y))
ax6	=	fig6.add_subplot(1,	1,	1)
plt.yticks(fontproperties = f_family)
plt.xticks(fontproperties = f_family) 
plt.tick_params(labelsize=18)
#ax6.scatter(dis_cd_x1,dis_cd_y1)
#ax6.scatter(dis_xa_x2,dis_xa_y2)
popt, pcov = curve_fit(func4, dis_cd_x1[3:],dis_cd_y1[3:],maxfev = 10000)
y888 = [func4(i, *popt) for i in dis_cd_x1]
ax6.scatter(dis_cd_x1,dis_cd_y1,label=r'D5, $\xi$=%.2f'%-popt[1],alpha=alpha_xy)
ax6.plot(dis_cd_x1,y888,color='b',linestyle='-')
popt, pcov = curve_fit(func4, dis_xa_x2[3:-2],dis_xa_y2[3:-2])
y777 = [func4(i, *popt) for i in dis_xa_x2[:]]
ax6.scatter(dis_xa_x2[:],dis_xa_y2[:],label=r'D6, $\xi$=%.2f'%-popt[1],alpha=alpha_xy)
ax6.plot(dis_xa_x2[:],y777,c='orange',linestyle='-')
ax6.set_yscale('log')
ax6.set_xscale('log')
ax6.set_ylim([0.000001,1])
ax6.set_xlim([0.1,100])
ax6.legend(loc=1,handletextpad=0.1,prop={'size':18,'family':f_family})
ax6.set_xlabel('log'+r'$_{10}\langle d \rangle$'+'(km)',size=18,family=f_family) 
ax6.set_ylabel('log'+r'$_{10}P(\langle d \rangle)$',size=18,family=f_family)
#plt.savefig('C:/python/摩拜单车/draw2/sf_4_cdxa6.pdf',bbox_inches='tight') 
 




